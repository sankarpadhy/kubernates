<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Kubernetes Learning</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        .component {
            cursor: pointer;
            transition: transform 0.3s;
            padding: 15px;
            margin: 10px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .component:hover {
            transform: scale(1.05);
        }
        .control-plane {
            background-color: #e3f2fd;
        }
        .worker-node {
            background-color: #f5f5f5;
        }
        .details-panel {
            padding: 20px;
            border-radius: 8px;
            background-color: #ffffff;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-top: 20px;
        }
        .animation-container {
            position: relative;
            height: 400px;
            border: 1px solid #ddd;
            border-radius: 8px;
            margin: 20px 0;
            overflow: hidden;
        }
        .pod {
            position: absolute;
            width: 60px;
            height: 60px;
            background-color: #bbdefb;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            transition: all 0.5s ease;
        }
        .interactive-terminal {
            background-color: #1e1e1e;
            color: #ffffff;
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            margin: 20px 0;
        }
        .command-input {
            background-color: transparent;
            border: none;
            color: #ffffff;
            width: 100%;
            outline: none;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="#">Kubernetes Interactive Learning</a>
        </div>
    </nav>

    <div class="container mt-4">
        <div class="row">
            <div class="col-md-12 mb-4">
                <h2>Kubernetes Architecture</h2>
                <div class="mermaid">
                    graph TD
                        subgraph "Control Plane (Master Node)"
                            API[API Server] --> ETCD[etcd]
                            API --> CM[Controller Manager]
                            API --> SCHED[Scheduler]
                            CM --> API
                            SCHED --> API
                        end

                        subgraph "Worker Node 1"
                            KL1[Kubelet] --> API
                            KP1[Kube Proxy] --> API
                            CR1[Container Runtime]
                            KL1 --> CR1
                        end

                        subgraph "Worker Node 2"
                            KL2[Kubelet] --> API
                            KP2[Kube Proxy] --> API
                            CR2[Container Runtime]
                            KL2 --> CR2
                        end

                        style API fill:#f9f,stroke:#333,stroke-width:2px
                        style ETCD fill:#bbf,stroke:#333,stroke-width:2px
                        style CM fill:#bfb,stroke:#333,stroke-width:2px
                        style SCHED fill:#fbf,stroke:#333,stroke-width:2px
                        style KL1,KL2 fill:#ff9,stroke:#333,stroke-width:2px
                        style KP1,KP2 fill:#f99,stroke:#333,stroke-width:2px
                        style CR1,CR2 fill:#9ff,stroke:#333,stroke-width:2px
                </div>
            </div>
            <div class="col-md-8">
                <div class="row mt-4">
                    <div class="col-md-6">
                        <div class="component control-plane" onclick="showDetails('apiserver')">
                            <h4>API Server</h4>
                            <p>The front door to the Kubernetes control plane</p>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="component control-plane" onclick="showDetails('etcd')">
                            <h4>etcd</h4>
                            <p>Distributed key-value store</p>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="component worker-node" onclick="showDetails('kubelet')">
                            <h4>Kubelet</h4>
                            <p>Node agent that runs on each node</p>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="component worker-node" onclick="showDetails('kubeproxy')">
                            <h4>Kube Proxy</h4>
                            <p>Network proxy on each node</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-4">
                <div class="details-panel" id="detailsPanel">
                    <h3>Component Details</h3>
                    <p>Click on any component to learn more</p>
                </div>

                <div class="interactive-terminal">
                    <div class="mb-2">Try Kubernetes commands:</div>
                    <input type="text" class="command-input" id="commandInput" 
                           placeholder="Enter kubectl command..." 
                           onkeypress="handleCommand(event)">
                    <div id="commandOutput" class="mt-2"></div>
                </div>
            </div>
        </div>

        <div class="row mt-4">
            <div class="col-12">
                <h3>Interactive Exercises</h3>
                <div class="list-group">
                    <a href="#" class="list-group-item list-group-item-action" onclick="startExercise('pods')">
                        <h5>Pod Lifecycle Exercise</h5>
                        <p>Learn how pods are created, scheduled, and managed</p>
                    </a>
                    <a href="#" class="list-group-item list-group-item-action" onclick="startExercise('services')">
                        <h5>Service Networking Exercise</h5>
                        <p>Understand how services enable pod communication</p>
                    </a>
                    <a href="#" class="list-group-item list-group-item-action" onclick="startExercise('deployment')">
                        <h5>Deployment Strategies Exercise</h5>
                        <p>Practice different deployment patterns</p>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script>
        const componentDetails = {
            apiserver: {
                title: 'API Server',
                description: 'The Kubernetes API server validates and configures data for the api objects which include pods, services, replicationcontrollers, and others.',
                responsibilities: [
                    'Authentication and Authorization',
                    'API Registration and Discovery',
                    'Request Processing',
                    'Resource Validation'
                ]
            },
            etcd: {
                title: 'etcd',
                description: 'etcd is a consistent and highly-available key-value store used as Kubernetes\' backing store for all cluster data.',
                responsibilities: [
                    'Storing Cluster State',
                    'Watching for Changes',
                    'Maintaining Consistency',
                    'Backup and Recovery'
                ]
            },
            kubelet: {
                title: 'Kubelet',
                description: 'The kubelet is the primary "node agent" that runs on each node in the cluster.',
                responsibilities: [
                    'Pod Management',
                    'Container Health Checks',
                    'Resource Reporting',
                    'Node Status Updates'
                ]
            },
            kubeproxy: {
                title: 'Kube Proxy',
                description: 'kube-proxy maintains network rules on nodes. These network rules allow network communication to your Pods from network sessions inside or outside of your cluster.',
                responsibilities: [
                    'Service Abstraction',
                    'Load Balancing',
                    'Network Rules Management',
                    'Connection Forwarding'
                ]
            }
        };

        function showDetails(component) {
            const details = componentDetails[component];
            const detailsHtml = `
                <h3>${details.title}</h3>
                <p>${details.description}</p>
                <h5>Key Responsibilities:</h5>
                <ul>
                    ${details.responsibilities.map(r => `<li>${r}</li>`).join('')}
                </ul>
            `;
            document.getElementById('detailsPanel').innerHTML = detailsHtml;
        }

        function handleCommand(event) {
            if (event.key === 'Enter') {
                const command = event.target.value;
                const output = document.getElementById('commandOutput');
                output.innerHTML += `<div>> ${command}</div>`;
                
                // Simulate command execution
                if (command.includes('kubectl')) {
                    setTimeout(() => {
                        output.innerHTML += `<div class="text-success">Simulated output for: ${command}</div>`;
                    }, 500);
                } else {
                    output.innerHTML += `<div class="text-danger">Error: Unknown command</div>`;
                }
                event.target.value = '';
            }
        }

        function startExercise(type) {
            const container = document.getElementById('architectureDemo');
            container.innerHTML = ''; // Clear existing content

            switch(type) {
                case 'pods':
                    simulatePodLifecycle(container);
                    break;
                case 'services':
                    simulateServiceNetworking(container);
                    break;
                case 'deployment':
                    simulateDeployment(container);
                    break;
            }
        }

        function simulatePodLifecycle(container) {
            const pod = document.createElement('div');
            pod.className = 'pod';
            pod.innerHTML = 'Pod';
            pod.style.left = '10px';
            pod.style.top = '10px';
            container.appendChild(pod);

            // Animate pod creation and scheduling
            setTimeout(() => {
                pod.style.left = '200px';
                pod.style.top = '150px';
            }, 1000);
        }

        // Initialize Mermaid
        mermaid.initialize({ startOnLoad: true, theme: 'default' });

        // Initialize the page
        document.addEventListener('DOMContentLoaded', () => {
            showDetails('apiserver'); // Show API Server details by default
        });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
